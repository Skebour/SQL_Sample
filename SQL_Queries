-- Create a statement to list all managers and their titles.
SELECT e.emp_no, e.first_name, e.last_name, t.title
FROM titles t
RIGHT JOIN employees e ON e.emp_no = t.emp_no
INNER JOIN dept_manager dm ON e.emp_no = dm.emp_no;

-- Create a statement to show the salary of all employees and their department name.
SELECT e.first_name, e.last_name, s.salary, d.dept_name
FROM employees e
LEFT JOIN salaries s ON (e.emp_no = s.emp_no AND e.emp_no NOT IN (SELECT emp_no FROM dept_manager))
LEFT JOIN dept_emp de ON e.emp_no = de.emp_no
LEFT JOIN departments d ON de.dept_no = d.dept_no
LEFT JOIN dept_manager dm ON d.dept_no = dm.dept_no;

-- Create a statement to show the hire date and birth date of those belonging to HR department.
SELECT e.emp_no, e.first_name, e.last_name, d.dept_name, d.dept_no, e.hire_no, e.hire_date, e.birth_date
FROM employees e 
LEFT JOIN dept_manager dm ON dm.emp_no
LEFT JOIN dept_emp de ON de.emp_no = e.emp_no
LEFT JOIN departments d ON d.dept.no = de.dept_no OR d.dept_no = dm.dept_no
WHERE dept_name = 'Human Resources' OR d.dept_no = 'd003';

-- Create a statement to show all departments and their department's managers.
SELECT e.emp, first_name, last_name, dm.dept_no, d.dept_name
FROM employees e
INNER JOIN dept_manager dm ON e.emp_no = dm.emp_no
INNER JOIN departments d ON dm.dept_no = d.dept_no;

-- Create a statement to show a list of HR's employees who were hired after 1986.
WITH cte1 AS (
SELECT e.emp_no, e.first_name, e.last_name, d.dept_name, d.dept_no, e.hire_date, e.birth_date
FROM employees e
LEFT JOIN dept_manager dm ON dm.emp_no = e.emp_no
LEFT JOIN dept_emp de ON de.emp_no = e.emp_no
LEFT JOIN departments d ON d.dept_no = de.dept_no OR d.dept_no = dm.dept_no)
SELECT * FROM cte1 WHERE dept_name = 'Human Resources' AND hire_date > '1986-00-00';



